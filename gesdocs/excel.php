 $("#list").jqGrid('navGrid', '#pager',{view:true, del:false, add:false, edit:false, excel:true}) .navButtonAdd('#pager',{ caption:"Export to Excel", buttonicon:"ui-icon-save", onClickButton: function(){ exportExcel(); }, position:"last" }); function exportExcel() { var mya=new Array();lista de millones de años =$("# "getDataIDs) ();. / / Obtener todos los datos var lista de identificadores de =$("#") GetRowData (millones de años [0]);. / / Obtener Primera fila para obtener el colNames var etiquetas = new Array (); ii var = 0; for (var i en los datos) {colNames [ii + +] = i;} / / captura de nombres de col HTML var = ""; for (i = 0; i mya.length <; i + + ) {lista =$("# de datos ") GetRowData (millones de años [i]);. / / obtener cada fila for (j = 0; j <colNames.length; j + +) {html = [HTML + datos colNames [j] ] + "\ t"; / / salida de cada columna como delimitada por tabuladores} HTML = HTML + "\ n"; / / salida de cada fila con el fin de línea} HTML = HTML + "\ n"; / / fin de línea al final document.forms [0] csvBuffer.value = html;. document.forms [0] = método 'POST';. document.forms [0] action = 'csvExport.php;. / / enviarla a un servidor que se abrirá esta contenido en el archivo de Excel document.forms [0] target = '_blank';. document.forms [0] submit ();.} 

Script PHP

 header('Content-type: application/vnd.ms-excel'); header("Content-Disposition: attachment; filename=file.xls"); header("Pragma: no-cache"); $buffer = $_POST['csvBuffer']; try{ echo $buffer; }catch(Exception $e){ } 
 <form method="post" action="csvExport.php"> <input type="hidden" name="csvBuffer" id="csvBuffer" value="" /> </form> 